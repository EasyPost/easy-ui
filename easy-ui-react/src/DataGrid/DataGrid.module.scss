@use "../styles/common" as *;
@use "../styles/unstyled";

.DataGrid {
  @include component-token(
    "data-grid",
    "header-bg",
    design-token("color.blue.800")
  );
  @include component-token(
    "data-grid",
    "header-text",
    design-token("color.white")
  );
  @include component-token("data-grid", "header-row-height", 48px);
  @include component-token("data-grid", "body-row-height", 56px);

  display: grid;
  grid-template-rows: auto;
  grid-template-areas: component-token("data-grid", "template-areas");
  grid-template-columns: component-token("data-grid", "template-columns");
  border: 1px solid design-token("color.gray.300");
  border-radius: design-token("shape.border_radius.md");
  overflow: auto;
  max-height: calc(
    2px +
      (
        component-token("data-grid", "header-row-height") +
          (
            component-token("data-grid", "body-row-height") *
              component-token("data-grid", "max-rows")
          )
      )
  );
  position: relative;
}

.columnHeader {
  @include font-style("subtitle2");

  position: sticky;
  top: 0;
  background: component-token("data-grid", "header-bg");
  color: component-token("data-grid", "header-text");
  height: component-token("data-grid", "header-row-height");
  z-index: 3;
  outline: none;

  display: inline-flex;
  align-items: center;
  gap: design-token("space.1");
}

.sortIcon {
  display: inline-flex;
  color: design-token("color.gray.700");

  &[data-sorted="true"] {
    color: design-token("color.gray.500");
  }
}

.row {
  display: contents;
}

.cell {
  @include font-style("body1");

  background: design-token("color.white");
  color: design-token("color.blue.800");
  height: component-token("data-grid", "body-row-height");
  z-index: 1;
}

.columnHeaderFocused,
.cellFocused {
  @include native-focus-ring;
  outline-offset: -1px;
}

.columnHeader,
.cell {
  display: inline-flex;
  align-items: center;

  padding: 0 design-token("space.2");

  &:first-child {
    padding-left: design-token("space.5");
  }
  &:last-child {
    padding-right: design-token("space.5");
  }
}

.expandRowButton {
  @include unstyled.button;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  width: 24px;
  height: 24px;

  cursor: pointer;

  &.expanded {
    transform: rotate(90deg);
  }
}

.expandedRowContent {
  position: absolute;
  left: 0;
  top: component-token("data-grid", "expanded-row-position");
  width: component-token("data-grid", "expanded-row-width");
  opacity: component-token("data-grid", "expanded-row-opacity");
  padding: design-token("space.1") design-token("space.5");
}

.rowHovered {
  .cell {
    background: design-token("color.gray.050");
    color: design-token("color.blue.700");
    font-weight: 500;
  }
}

.rowExpanded {
  .cell {
    font-weight: 600;
    margin-bottom: component-token("data-grid", "expanded-row-height");
  }
}

.hasRowActions {
  .columnHeader,
  .cell {
    &:last-child {
      padding-left: design-token("space.0.5");
      padding-right: design-token("space.2");
      position: sticky;
      right: -12px;
      z-index: 2;
    }
    &:nth-last-child(2) {
      padding-right: design-token("space.1.5");
    }
  }
  .columnHeader {
    &:last-child {
      z-index: 4;
    }
  }
}

.cell:nth-child(1) {
  position: sticky;
  left: -16px;
  z-index: 2;
}

.columnHeader:nth-child(1) {
  left: -16px;
  z-index: 4;
}

.hasSelection,
.hasExpansion {
  .cell:nth-child(1) {
    left: 0;
  }
  .columnHeader:nth-child(1) {
    left: 0;
  }
  .cell:nth-child(2) {
    position: sticky;
    left: 48px;
    z-index: 2;
  }
  .columnHeader:nth-child(2) {
    left: 48px;
    z-index: 4;
  }
  .columnHeader,
  .cell {
    &:first-child {
      padding-left: design-token("space.2");
      padding-right: design-token("space.1");
    }
    & + * {
      padding-left: 0;
    }
  }
}

.contents {
  display: contents;
}

.headerSecondary {
  @include component-token(
    "data-grid",
    "header-bg",
    design-token("color.gray.050")
  );
  @include component-token(
    "data-grid",
    "header-text",
    design-token("color.blue.800")
  );
}
